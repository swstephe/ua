doctype html
html(ng-app='controls')
  head
    title Switch control
    link(rel='stylesheet',href='/bootstrap/css/bootstrap.css')
    style.
      .switch {
        padding: 4px;
        width: 40px;
        display: inline-block;
        text-align: center;
        cursor: pointer;
      }
      .switch.yes {
        border: 2px solid green;
        background-color: green;
        color: white;
      }
      .switch.no {
        border: 2px solid red;
        color: red;
      }
  body
    .container-fluid
      h2 Is this an open water dive?
      div(my-switch-control,ng-model='switchValue')
      h3 The value of the switch control is: {{switchValue}}
    script(src='/angular/angular.js')
    script
      :coffee-script
        angular
        .module 'controls', []
        .directive 'mySwitchControl', ->
          require: 'ngModel'
          scope: {}
          link: (scope, element, attrs, ctrl) ->
            element.on 'click', ->
              scope.stateValue = not scope.stateValue
              scope.$apply (-> ctrl.$setViewValue scope.stateValue)
              ctrl.$render()
            ctrl.$render = ->
              if scope.stateValue
                element.removeClass 'no'
                element.addClass 'yes'
                element.text "Yes"
              else
                element.removeClass 'yes'
                element.addClass 'no'
                element.text "No"
            scope.stateValue = false
            element.addClass 'switch'
            ctrl.$setViewValue scope.stateValue
            ctrl.$render()
